var blockly_mario;(function(){function t(t,n,e){return Blockly.JavaScript.valueToCode(t,n,e)}function n(t){return["Enjine.Keys[{",['down: "Down"','left: "Left"','jump: "S"','right: "Right"','shoot: "A"','up: "Up"'].join(", "),"}[",t,"]]"].join("")}Blockly.Language.agent_act={init:function(){this.setColour(290),this.appendDummyInput().appendTitle("activate"),this.appendValueInput("ACTION").setCheck(String),this.appendValueInput("VALUE").setCheck(Boolean),this.setInputsInline(!0),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip("")}},Blockly.Language.agent_action={init:function(){this.setColour(160),this.appendDummyInput().appendTitle(new Blockly.FieldDropdown([["jump","jump"],["shoot","shoot"],["left","left"],["right","right"],["up","up"],["down","down"]]),"VALUE"),this.setInputsInline(!0),this.setOutput(!0,String),this.setTooltip("")}},Blockly.Language.agent_isActive={init:function(){this.setColour(120),this.appendDummyInput().appendTitle("is"),this.appendValueInput("ACTION").setCheck(String),this.appendDummyInput().appendTitle("active"),this.setInputsInline(!0),this.setOutput(!0,Boolean),this.setTooltip("")}},Blockly.JavaScript.agent_act=function(){var e=t(this,"ACTION",Blockly.JavaScript.ORDER_NONE),i=t(this,"VALUE",Blockly.JavaScript.ORDER_ASSIGNMENT),a=["Enjine.KeyboardInput.Pressed[",n(e),"] = ",i,";\n"].join("");return a},Blockly.JavaScript.agent_action=function(){var t='"'+this.getTitleValue("VALUE")+'"';return[t,Blockly.JavaScript.ORDER_ATOMIC]},Blockly.JavaScript.agent_isActive=function(){var e=t(this,"ACTION",Blockly.JavaScript.ORDER_NONE),i="Enjine.KeyboardInput.Pressed["+n(e)+"]";return[i,Blockly.JavaScript.ORDER_MEMBER]}})(blockly_mario||(blockly_mario={}));var blockly_mario;(function(blockly_mario){function $(t){return document.getElementById(t)}function $input(t){return $(t)}function copySimpleShallow(t){var n={};for(var e in t)n[e]=t[e];return n}function handleKeyDown(t){return function(n){if(this.IsActive()&&32==n.keyCode){var e=$input("pause");e.checked=!e.checked,handlePause()}else t.call(this,n)}}function handlePause(){$input("pause").checked?application.timer.Stop():application.timer.Start()}function updateCode(){var code=Blockly.Generator.workspaceToCode("JavaScript");code=["(function() {",code,"})"].join("\n");try{aiFunction=eval(code),$input("ai").disabled=!1}catch(e){throw alert("Error building code."),aiFunction=null,$input("ai").checked=!1,$input("ai").disabled=!0,e}}var aiFunction,application;window.onload=function(){application=new Enjine.Application,application.Initialize(new Mario.LoadingState("../mariohtml5/"),320,240),application.timer.UpdateObject=new AiUpdate(application),Enjine.KeyboardInput.KeyDownEvent=handleKeyDown(Enjine.KeyboardInput.KeyDownEvent),Blockly.inject($("blockly"),{path:"../blockly/",toolbox:$("toolbox")}),$input("pause").checked=!1,$("pause").onclick=handlePause,$("update").onclick=updateCode,$input("ai").disabled=!0};var AiUpdate=function(){function t(t){this.base=t}return t.prototype.Update=function(t){var n,e=$input("ai").checked;e&&(n=Enjine.KeyboardInput.Pressed,Enjine.KeyboardInput.Pressed={},Enjine.KeyboardInput.Element=null,aiFunction&&aiFunction()),this.base.Update(t),e&&(Enjine.KeyboardInput.Pressed=n,Enjine.KeyboardInput.Element=$("canvas"))},t}()})(blockly_mario||(blockly_mario={}));